<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Surprising Happy Birthday 🎉</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#7c3aed}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:radial-gradient(ellipse at 10% 10%, #061126 0%, transparent 25%), radial-gradient(ellipse at 90% 90%, #0a1b2b 0%, transparent 25%), var(--bg);color:#e6eef8;display:flex;align-items:center;justify-content:center}

    .stage{width:min(980px,94vw);height:min(700px,84vh);background:linear-gradient(180deg,#07112644,transparent);border-radius:18px;box-shadow:0 10px 40px rgba(2,6,23,.6);position:relative;overflow:hidden;padding:28px;display:grid;grid-template-columns:1fr 360px;gap:20px}

    /* Left - main spectacle */
    .main{position:relative;border-radius:12px;padding:24px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);display:flex;flex-direction:column;align-items:center;justify-content:center;overflow:hidden}
    h1{margin:8px 0 6px;font-size: clamp(28px,4vw,44px);letter-spacing:1px;text-align:center}
    p.lead{margin:0 0 16px;color:#bcd5ffcc;text-align:center;max-width:680px}

    /* cake */
    .cake-wrap{position:relative;width:360px;height:280px;display:flex;align-items:flex-end;justify-content:center}
    .cake{width:320px;height:160px;border-radius:16px 16px 12px 12px;background:linear-gradient(180deg,#ffd9c8,#ffb199);position:relative;box-shadow:0 6px 20px rgba(0,0,0,.35);transform-origin:center;transition:transform .6s cubic-bezier(.16,.9,.3,1)}
    .frosting{position:absolute;top:-18px;left:0;right:0;height:48px;background:linear-gradient(90deg,#fff9,#ffe8);border-radius:18px 18px 0 0;box-shadow:inset 0 -6px 14px rgba(0,0,0,.06)}
    .plate{position:absolute;bottom:-18px;width:420px;height:30px;background:linear-gradient(90deg,#fff2,#ffffff11);border-radius:20px}

    /* candles */
    .candles{position:absolute;top:-34px;left:50%;transform:translateX(-50%);display:flex;gap:12px}
    .candle{width:14px;height:46px;background:linear-gradient(180deg,#ffefef,#ffdede);border-radius:4px;position:relative;display:flex;align-items:flex-start;justify-content:center}
    .wick{position:absolute;top:-6px;width:2px;height:8px;background:#222}
    .flame{position:absolute;top:-20px;width:10px;height:18px;border-radius:50% 50% 45% 45%;transform-origin:50% 80%;animation:flicker 900ms infinite}
    .flame:before{content:'';position:absolute;left:50%;transform:translateX(-50%);width:6px;height:10px;border-radius:50%;top:3px}
    .flame.small{width:6px;height:10px}
    .flame.orange{background: radial-gradient(circle at 30% 30%, #fff7c7 0%, #ffaf3b 30%, #ff5a00 70%)}
    .flame.pink{background: radial-gradient(circle at 30% 30%, #fff0ff 0%, #ff91d0 30%, #ff3aa6 70%)}
    @keyframes flicker{0%{transform:translateY(0) scaleY(1)}50%{transform:translateY(-2px) scaleY(.95)}100%{transform:translateY(0) scaleY(1)}}

    /* right panel */
    .panel{padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:12px;display:flex;flex-direction:column;gap:12px}
    .controls{display:flex;flex-direction:column;gap:10px}
    button{cursor:pointer;border:0;padding:10px 14px;border-radius:10px;font-weight:600}
    .btn-primary{background:linear-gradient(90deg,var(--accent),#5b21b6);color:white;box-shadow:0 6px 18px rgba(124,58,237,.18)}
    .btn-ghost{background:transparent;border:1px dashed rgba(255,255,255,.06);color:lightblue}

    .small{font-size:13px;color:#97b1db}

    /* confetti canvas occupies full stage */
    canvas#confetti{position:absolute;inset:0;pointer-events:none}

    /* little surprise card */
    .surprise{margin-top:auto;padding:12px;background:linear-gradient(180deg,#06102b11,transparent);border-radius:10px;text-align:center}

    /* fireworks particles */
    .sparkles{position:absolute;inset:0;pointer-events:none}

    /* responsive */
    @media (max-width:920px){.stage{grid-template-columns:1fr}.panel{order:2}}
  </style>
</head>
<body>
  <div class="stage">
    <canvas id="confetti"></canvas>
    <div class="main">
      <h1 id="title">Surprise! Happy Birthday Sir Jelson🎉</h1>
      <p class="lead">A little interactive celebration. Click <strong>Surprise</strong></p>

      <div class="cake-wrap" aria-hidden="true">
        <div class="cake" id="cake">
          <div class="frosting"></div>
          <div class="candles" id="candles">
            <!-- candles will be generated by JS -->
          </div>
        </div>
        <div class="plate"></div>
      </div>

      <div id="audioHint" class="small" style="opacity:.7"></div>
    </div>

    <aside class="panel">
      <div>
        <div style="display:flex;gap:12px;align-items:center;justify-content:space-between">
          <div>
            <div style="font-weight:700">For: <span id="nameTarget">Sir Lanto</span></div>
          </div>
          <div style="text-align:right">
            <div class="small">Date: <span id="dateNow"></span></div>
          </div>
        </div>
      </div>

      <div class="controls">
        <button class="btn-primary" id="surpriseBtn">Surprise!</button>
        <button class="btn-ghost" id="blowBtn">Blow out candles</button>
        <div style="display:flex;gap:8px">
          <button id="fireworksBtn" class="btn-primary">Fireworks</button>
          <button id="resetBtn" class="btn-ghost">Reset</button>
        </div>

        <label class="small">Confetti density</label>
        <input id="density" type="range" min="5" max="120" value="48">

        <div class="surprise">
          <div style="font-weight:700">Hidden message</div>
          <div class="small">Click the cake to reveal a secret message.</div>
        </div>
      </div>

      <div style="margin-top:6px;font-size:13px;color:#bcd5ffcc">Tip: after surprising, try blowing the candles — sound + particles create the full effect.</div>
    </aside>

    <!-- sparkles layer (SVG) -->
    <svg class="sparkles" id="sparklesSvg" viewBox="0 0 800 600" preserveAspectRatio="none" style="position:absolute;left:0;top:0;width:100%;height:100%"></svg>

  </div>

  <script>
    // small helper: random
    const rand = (a,b)=>Math.random()*(b-a)+a;

    // set date
    document.getElementById('dateNow').textContent = new Date().toLocaleDateString();

    // generate candles
    const candlesEl = document.getElementById('candles');
    const candleCount = 7;
    for(let i=0;i<candleCount;i++){
      const c = document.createElement('div');c.className='candle';
      const wick = document.createElement('div');wick.className='wick';
      const flame = document.createElement('div');flame.className='flame '+(i%2? 'orange':'pink');
      if(Math.random()>0.7) flame.classList.add('small');
      c.appendChild(wick);c.appendChild(flame);candlesEl.appendChild(c);
    }

    // interactive title edit
    // const title = document.getElementById('title');
    // title.addEventListener('dblclick',()=>{
    //   const name = prompt('Happy Birthday Sir Jelson', title.textContent) || title.textContent;
    //   title.textContent = name;
    // });

    // confetti canvas
    const confettiCanvas = document.getElementById('confetti');
    const ctx = confettiCanvas.getContext('2d');
    function resizeCanvas(){confettiCanvas.width = confettiCanvas.clientWidth;confettiCanvas.height = confettiCanvas.clientHeight}
    new ResizeObserver(resizeCanvas).observe(confettiCanvas);
    resizeCanvas();

    // particle stores
    let confettiParticles = [];
    function makeConfetti(x,y,count=60,density=48){
      for(let i=0;i<count;i++){
        confettiParticles.push({x,y,vx:rand(-6,6),vy:rand(-14,-3),r:rand(6,12),rot:rand(0,Math.PI*2),vr:rand(-0.2,0.2),col:['#ff595e','#ffca3a','#8ac926','#1982c4','#6a4c93'][Math.floor(rand(0,5))],life:rand(120,240)});
      }
    }

    // fireworks particles
    const fireworks = [];
    function makeFirework(x,y,baseCount=80){
      const hue = Math.floor(rand(0,360));
      for(let i=0;i<baseCount;i++){
        const a = rand(0,Math.PI*2), s = rand(1,6);
        fireworks.push({x,y,vx:Math.cos(a)*s,vy:Math.sin(a)*s,life:rand(40,160),hue: (hue + rand(-30,30))});
      }
    }

    // sparkles svg
    const svg = document.getElementById('sparklesSvg');
    function makeSparkle(xPct,yPct,size=8,ttl=900){
      const c = document.createElementNS('http://www.w3.org/2000/svg','circle');
      c.setAttribute('cx', xPct+'%');c.setAttribute('cy', yPct+'%');c.setAttribute('r', size/2);
      c.setAttribute('fill','white');c.setAttribute('opacity','0.9');
      svg.appendChild(c);
      const dur = ttl; const start = performance.now();
      (function tick(){
        const t = (performance.now()-start)/dur; if(t>1){c.remove();return}
        c.setAttribute('opacity', String(1 - t));
        c.setAttribute('r', String((1 - t)*(size/1.6) + 1));
        requestAnimationFrame(tick);
      })();
    }

    // audio: make a quick whoosh and pop using WebAudio
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playWhoosh(volume=0.12){
      try{
        const o = audioCtx.createOscillator();const g = audioCtx.createGain();
        o.type='sawtooth';o.frequency.value=220;g.gain.value=volume; o.connect(g);g.connect(audioCtx.destination);
        o.start();g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime+0.5);o.stop(audioCtx.currentTime+.5);
      }catch(e){/*silent*/}
    }
    function playPop(){
      try{
        const o = audioCtx.createOscillator();const g = audioCtx.createGain();
        o.type='square';o.frequency.value=880;g.gain.value=0.08; o.connect(g);g.connect(audioCtx.destination);
        o.start();g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime+.2);o.stop(audioCtx.currentTime+.2);
      }catch(e){}
    }

    // animation loop
    let last = performance.now();
    function loop(t){
      const dt = t-last; last=t;
      // confetti physics
      ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
      for(let i=confettiParticles.length-1;i>=0;i--){
        const p = confettiParticles[i];
        p.vy += 0.18; p.vx *= 0.995; p.vy *= 0.999; p.x += p.vx; p.y += p.vy; p.rot += p.vr; p.life--;
        ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot);
        ctx.fillStyle=p.col; ctx.fillRect(-p.r/2,-p.r/2,p.r,p.r*0.6); ctx.restore();
        if(p.y > confettiCanvas.height + 50 || p.x < -50 || p.x > confettiCanvas.width+50 || p.life<=0) confettiParticles.splice(i,1);
      }

      // fireworks
      for(let i=fireworks.length-1;i>=0;i--){
        const f = fireworks[i]; f.vy += 0.06; f.vx *= 0.999; f.x += f.vx; f.y += f.vy; f.life--;
        ctx.beginPath(); ctx.globalAlpha = Math.max(0, f.life/160); ctx.fillStyle = 'hsl('+f.hue+',80%,'+(Math.max(40,Math.min(70,f.life/3)))+'%)'; ctx.arc(f.x,f.y, Math.max(1, f.life/18),0,Math.PI*2); ctx.fill(); ctx.globalAlpha=1;
        if(f.life<=0 || f.y>confettiCanvas.height+20) fireworks.splice(i,1);
      }

      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);

    // interactions
    const surpriseBtn = document.getElementById('surpriseBtn');
    const blowBtn = document.getElementById('blowBtn');
    const fireworksBtn = document.getElementById('fireworksBtn');
    const resetBtn = document.getElementById('resetBtn');
    const cake = document.getElementById('cake');

    function doSurprise(){
      // subtle tilt
      cake.style.transform = 'translateY(-6px) rotate(-2deg) scale(1.02)';
      setTimeout(()=>cake.style.transform='translateY(0) rotate(0) scale(1)',1200);
      // confetti burst from center
      const rect = confettiCanvas.getBoundingClientRect();
      makeConfetti(rect.width/2, rect.height/3, Number(document.getElementById('density').value), Number(document.getElementById('density').value));
      // sparkle svg
      for(let i=0;i<12;i++){makeSparkle(rand(30,70), rand(10,50), rand(4,12), rand(400,1200));}
      playWhoosh(0.12);setTimeout(()=>playPop(),220);
    }

    function doBlow(){
      // extinguish flames
      document.querySelectorAll('.flame').forEach((el)=>{
        el.style.transition='all 420ms ease'; el.style.transform='scaleY(.2) translateY(10px)'; el.style.opacity='0';
      });
      // gust of particles
      const rect = confettiCanvas.getBoundingClientRect();
      for(let i=0;i<6;i++) makeConfetti(rect.width/2+rand(-120,120), rect.height/3+rand(-20,60), 24, 48);
      // soft firework pops
      for(let i=0;i<4;i++) makeFirework(rand(rect.width*0.2,rect.width*0.8), rand(rect.height*0.05,rect.height*0.5), 36);
      playWhoosh(0.06); setTimeout(()=>playPop(),240);
      // reveal message after a pause
      setTimeout(()=>revealSecret(),900);
    }

    function doFireworks(){
      const rect = confettiCanvas.getBoundingClientRect();
      for(let i=0;i<8;i++){
        makeFirework(rand(rect.width*0.15,rect.width*0.85), rand(rect.height*0.05,rect.height*0.4), 80);
      }
      playWhoosh(0.16);
    }

    function revealSecret(){
      if(document.getElementById('secret')) return; // already revealed
      const s = document.createElement('div'); s.id='secret'; s.style.position='absolute'; s.style.left='50%'; s.style.top='28%'; s.style.transform='translate(-50%,-50%)'; s.style.padding='18px 26px'; s.style.borderRadius='12px'; s.style.background='linear-gradient(90deg,#111827cc,#0b1220cc)'; s.style.boxShadow='0 14px 40px rgba(0,0,0,.45)'; s.style.textAlign='center'; s.style.fontSize='20px'; s.innerHTML = '<div style="font-weight:800;font-size:20px">Surprise 🎁</div><div style="margin-top:6px;color:#bcd5ff">Happy Birthday po Sir Lanto! Salamat po sa pagtuturo sa amin. Wishing you joy, code, and lots of cake!</div>';
      document.querySelector('.stage').appendChild(s);
      // tiny confetti + sparkle
      const rect = confettiCanvas.getBoundingClientRect(); makeConfetti(rect.width/2, rect.height/3, 60);
    }

    // cake click toggles secret
    cake.addEventListener('click',()=>{revealSecret(); playPop();});

    surpriseBtn.addEventListener('click',()=>{ // resume audio on first gesture
      if(audioCtx.state!=='running') audioCtx.resume(); doSurprise();});
    blowBtn.addEventListener('click',()=>{if(audioCtx.state!=='running') audioCtx.resume(); doBlow();});
    fireworksBtn.addEventListener('click',()=>{if(audioCtx.state!=='running') audioCtx.resume(); doFireworks();});
    resetBtn.addEventListener('click',()=>{
      // restore flames
      document.querySelectorAll('.flame').forEach((el)=>{el.style.opacity='1';el.style.transform='scaleY(1) translateY(0)'});
      // remove secret
      const s = document.getElementById('secret'); if(s) s.remove();
      confettiParticles = []; fireworks.length=0; svg.innerHTML='';
    });

    // clicking on canvas area triggers random tiny party
    confettiCanvas.addEventListener('click',(e)=>{
      const r = confettiCanvas.getBoundingClientRect(); makeConfetti(e.clientX-r.left, e.clientY-r.top, 28); playPop();
    });

    // small responsive scaling for fireworks creation positions
    // update density label (no label shown, but the range affects confetti count in surprise)

    // make initial idle sparkle
    setTimeout(()=>{for(let i=0;i<6;i++)makeSparkle(rand(20,80),rand(6,40),rand(4,8),rand(600,1600))},600);

    // optional: keyboard shortcuts
    window.addEventListener('keydown',(e)=>{
      if(e.key===' '){e.preventDefault(); surpriseBtn.click()}
      if(e.key==='b') blowBtn.click();
      if(e.key==='f') fireworksBtn.click();
    });

    // small accessibility: allow user to set target name
    const nameTarget = document.getElementById('nameTarget');
    nameTarget.addEventListener('click',()=>{const n=prompt('Who is this for?', nameTarget.textContent)||nameTarget.textContent; nameTarget.textContent=n});

  </script>
</body>
</html>
